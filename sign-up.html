<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="css/main.css">
        <style>
          .inputHint {color: red;}
        </style>
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

<!--=============================================================================-->
<!-- end HTML5 boilerplate starter code =========================================-->
<!--=============================================================================-->

<!--
PSUEDO-CODE for FLOW

Enter class watcher sign-up site
Ask for email, name, phone number, reference
Fields completed 
Enter field data into database
Send pmerritt a text message with info
Send test text through email gateway
Send confirmation email 
  Acknowledge presence of user in database
  Give them link to sign up at
Enter class watcher site
...

-->
  <form action="sign-up.php" method="get">

    <h1>UCSC Class Watcher</h1>

    <h2>Sign-Up</h2>
    <p>
    </p>

    <div>
      <span>Enter your name (first and last)</span>
      <div>
        <input type="text" maxlength="100" name="name" value="" />
      </div>
    </div>

    <div>
      <span>Enter your UCSC email (eg. sslug@ucsc.edu)</span>
      <div>
        <input type="text" maxlength="100" name="email" value="" />
      </div>
    </div>

    <div>
      <span>Enter your cell phone number 
            (this cell phone must have texting)</span>
      <div>
        <input type="text" maxlength="20" name="phone" value="" />
      </div>
    </div>

    <div>
      <span>Enter your reference 
            (leave blank if you know the site creator personally)</span>
      <div>
        <input type="text" maxlength="100" name="ref" value="" />
      </div>
    </div>

    <!-- Submit button goes here -->
    <div>
      <button type="submit" disabled="disabled">Submit</button>
    </div>

  </form>

<!--===============================================================================-->
<!-- start HTML5 boilerplate starter code =========================================-->
<!--===============================================================================-->

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.8.3.min.js"><\/script>')</script>
        <script src="js/plugins.js"></script>
        <script src="js/main.js"></script>

<!-- below script to be later put into main.js or something -->
<script>

  // @param elt an input element
  // @return true if elt has non-empty value,
  //         false otherwise
  function isInputValid(elt) {

    if (!elt) {
      return false;
    }

    inputVal = elt.val();
    if (!inputVal || (inputVal.trim().length < 1)) {
      return false;
    }

    return true;
  }

  // @return true if name input field is not just white space,
  //         false otherwise
  function isNameValid() {
    return isInputValid( $('input[name=name]') );
  }

  // @return true if email input field is not just white space
  //         and contains @ and . in the right order,
  //         false otherwise
  function isEmailValid() {

    var elt = $('input[name=email]');
    if (!isInputValid(elt)) {
      return false;
    }
    
    return /^\w+@ucsc.edu$/.test(elt.val().trim());
  }

  // @return true if phone has 3 digits followed by 3 then 4
  //         more digits, false otherwise
  function isPhoneValid() {

    var elt = $('input[name=phone]');
    if (!isInputValid(elt)) {
      return false;
    }

    return /^.*\d\d\d.*\d\d\d.*\d\d\d\d.*$/.test(elt.val().trim());
  }

  // Makes submit button click-able once all input elements have
  // valid values.
  function enableSubmitIfAllInputValid() {

      if (isNameValid() && isEmailValid() && isPhoneValid()) {

        $('button[type=submit]').removeAttr('disabled');
      }
  }

  // @return an htmlString for a span with hintText as the text
  function generateValidationHintSpan(hintText) {
    return '<span class=\'inputHint\'>' + hintText + '</span>';
  }

  // Any time the name field in the form changes validate it
  $('input[name=name]').bind(
    'change',
    function() {

      // If validation fails on name field, post a hint
      if (!isNameValid()) {

        // If hint not already present add one
        if ($(this).next('span').length == 0) {
          var hint = 'Please enter a name before continuing.';
          $(this).after(generateValidationHintSpan(hint));
        }
      }
      // Otherwise remove the hint and check to see if the whole
      // form is validated and the submit button can be enabled
      else {

        // Remove previously added field hint since field now valid
        if ($(this).next('span')) {
          $(this).next('span').remove();
        }
        enableSubmitIfAllInputValid();
      }
    }
  );

  // Any time the email field in the form changes validate it
  $('input[name=email]').bind(
    'change',
    function() {

      // If validation fails on email field, post a hint
      if (!isEmailValid()) {

        // If hint not already present add one
        if ($(this).next('span').length == 0) {
          var hint = 'Please enter a ucsc email (ending in @ucsc.edu) before continuing.';
          $(this).after(generateValidationHintSpan(hint));
        }
      }
      // Otherwise remove the hint and check to see if the whole
      // form is validated and the submit button can be enabled
      else {

        // Remove previously added field hint since field now valid
        if ($(this).next('span')) {
          $(this).next('span').remove();
        }
        enableSubmitIfAllInputValid();
      }
    }
  );

  // Any time the phone field in the form changes validate it
  $('input[name=phone]').bind(
    'change',
    function() {

      // If validation fails on phone field, post a hint
      if (!isPhoneValid()) {

        // If hint not already present add one
        if ($(this).next('span').length == 0) {
          var hint = 'Please enter a phone number with an area code before continuing (for example 831-555-5555).';
          $(this).after(generateValidationHintSpan(hint));
        }
      }
      // Otherwise remove the hint and check to see if the whole
      // form is validated and the submit button can be enabled
      else {

        // Remove previously added field hint since field now valid
        if ($(this).next('span').length == 1) {
          $(this).next('span').remove();
        }
        enableSubmitIfAllInputValid();
      }
    }
  );

</script>

        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html>
